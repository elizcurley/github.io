<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{% if page.title %}{{ page.title }} — {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Styles -->
  <link rel="stylesheet" href="{{ '/assets/styles.css' | relative_url }}?v=2">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@700;900&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- Minimal safety CSS so header is fixed and content is offset (you can move this to styles.scss later) -->
  <style>
    :root{ --header-h: 64px; }
    .site-header{ position:fixed; top:0; left:0; right:0; z-index:1000; }
    main.container{ padding-top: calc(var(--header-h) + 16px); }
  </style>

  {% seo %}
  {% if site.plausible_domain %}
  <script defer data-domain="{{ site.plausible_domain }}" src="https://plausible.io/js/script.js"></script>
  {% endif %}
</head>
<body class="theme-mm{% if page.bg == 'stretched' %} bg-stretched{% endif %}">
  {% include header.html %}
  <main id="content" class="container">
    {{ content }}
  </main>
  {% include footer.html %}

  <script>
    // --- Header height → push content below fixed header
    const headerEl = document.querySelector('.site-header');
    function setHeaderHeight(){
      if (!headerEl) return;
      document.documentElement.style.setProperty('--header-h', headerEl.offsetHeight + 'px');
    }
    setHeaderHeight();
    window.addEventListener('resize', setHeaderHeight);

    // --- Mobile nav toggle
    const btn = document.querySelector('[data-nav-toggle]');
    const nav = document.getElementById('site-nav');
    if (btn && nav) {
      btn.addEventListener('click', () => {
        const open = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!open));
        nav.classList.toggle('is-open', !open);
        setHeaderHeight(); // header height can change when menu opens
      });
    }
  </script>
</body>
</html>
